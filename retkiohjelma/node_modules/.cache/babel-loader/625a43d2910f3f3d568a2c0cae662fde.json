{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/sauli/OneDrive/Ty\\xF6p\\xF6yt\\xE4/JAMK/retkisofta/retkiohjelma/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/sauli/OneDrive/Ty\\xF6p\\xF6yt\\xE4/JAMK/retkisofta/retkiohjelma/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _createForOfIteratorHelper from\"C:/Users/sauli/OneDrive/Ty\\xF6p\\xF6yt\\xE4/JAMK/retkisofta/retkiohjelma/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _toConsumableArray from\"C:/Users/sauli/OneDrive/Ty\\xF6p\\xF6yt\\xE4/JAMK/retkisofta/retkiohjelma/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/sauli/OneDrive/Ty\\xF6p\\xF6yt\\xE4/JAMK/retkisofta/retkiohjelma/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useSpring,animated}from\"react-spring\";import Map from\"./Map\";import BarChart from\"./BarChart\";import PieChart from\"./PieChart\";import{BeatLoader}from\"react-spinners\";// Ilman näitä kartta ei toimi serverillä\n// eslint-disable-next-line import/no-webpack-loader-syntax\nimport MapboxWorker from\"worker-loader!mapbox-gl/dist/mapbox-gl-csp-worker\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";mapboxgl.workerClass=MapboxWorker;// Tulikartta API\nvar API_URL=\"https://tulikartta.fi/api-json2.php\";function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),paikat=_useState2[0],setPaikat=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),maakunnat=_useState4[0],setMaakunnat=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),tyypit=_useState6[0],setTyypit=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),valittuMaakunta=_useState8[0],setValittuMaakunta=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),valittuTyyppi=_useState10[0],setValittuTyyppi=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),rajatutPaikat=_useState12[0],setRajatutPaikat=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),paikatMaakunnassa=_useState14[0],setPaikatMaakunnassa=_useState14[1];var _useState15=useState(),_useState16=_slicedToArray(_useState15,2),newLat=_useState16[0],setNewLat=_useState16[1];var _useState17=useState(),_useState18=_slicedToArray(_useState17,2),newLong=_useState18[0],setNewLong=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),toggleMaakunnatClick=_useState20[0],setToggleMaakunnatClick=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),toggleTyypitClick=_useState22[0],setToggleTyypitClick=_useState22[1];var _useState23=useState([]),_useState24=_slicedToArray(_useState23,2),chartData=_useState24[0],setChartData=_useState24[1];var _useState25=useState(true),_useState26=_slicedToArray(_useState25,2),isLoading=_useState26[0],setIsLoading=_useState26[1];// Maakunnat -valikon dropdown animaatio\nvar maakunnatFade=useSpring({position:\"absolute\",border:toggleMaakunnatClick?1:0,height:toggleMaakunnatClick?100:0,width:200});// Tyypit -valikon dropdown animaatio\nvar tyypitFade=useSpring({position:\"absolute\",border:toggleTyypitClick?1:0,height:toggleTyypitClick?100:0,width:200});// Sivun latautuessa haetaan data\nuseEffect(function(){fetch(API_URL,{\"Content-Type\":\"application/json\",Accept:\"application/json\"}).then(function(response){console.log(response);return response.json();}).then(function(jsonData){var paikatArr=_toConsumableArray(jsonData);var maakunnatArr=[];var tyypitArr=[];tyypitArr.push(\"Näytä kaikki\");var _iterator=_createForOfIteratorHelper(paikatArr),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var i=_step.value;maakunnatArr.push(i.maakunta);tyypitArr.push(i.tyyppi);}}catch(err){_iterator.e(err);}finally{_iterator.f();}var maakunnatRemoveDuplicates=_toConsumableArray(new Set(maakunnatArr));var tyypitRemoveDublicates=_toConsumableArray(new Set(tyypitArr));setPaikat(_toConsumableArray(jsonData));setMaakunnat(_toConsumableArray(maakunnatRemoveDuplicates));setTyypit(_toConsumableArray(tyypitRemoveDublicates));setIsLoading(false);});},[]);// Päivitetään paikat valitussa maakunnassa kun valitaan maakunta\nuseEffect(function(){paivitaPaikatMaakunnassa();paivitaChartData();return function(){};},[valittuMaakunta]);// Päivitetään kaikki paikat kun valitaan tyyppi\nuseEffect(function(){paivitaPaikat();},[valittuTyyppi]);// Päivittää kaavioille lähetettävän datan\nvar paivitaChartData=function paivitaChartData(){var chartDataArr=paikat.filter(function(paikka){return paikka.maakunta==valittuMaakunta;});setChartData([chartDataArr]);};// Päivittää paikat valitussa maakunnassa\nvar paivitaPaikatMaakunnassa=function paivitaPaikatMaakunnassa(){var paikatMaakunnassaArr=[];if(valittuTyyppi==\"Näytä kaikki\"||valittuTyyppi==\"\"){paikatMaakunnassaArr=paikat.filter(function(paikka){return paikka.maakunta==valittuMaakunta;});setChartData([paikatMaakunnassaArr]);}else{paikatMaakunnassaArr=paikat.filter(function(paikka){return paikka.maakunta==valittuMaakunta&&paikka.tyyppi==valittuTyyppi;});}setPaikatMaakunnassa([paikatMaakunnassaArr]);setRajatutPaikat([paikatMaakunnassaArr]);if(valittuMaakunta!=\"\"&&paikatMaakunnassaArr[0]){var splitKoordinaatit=paikatMaakunnassaArr[0].koordinaatti.split(\",\");setNewLat(splitKoordinaatit[0]);setNewLong(splitKoordinaatit[1]);}};// Päivittää kaikki paikat valitun maakunnan ja tyypin mukaan\nvar paivitaPaikat=function paivitaPaikat(){if(valittuMaakunta!=\"\"&&valittuTyyppi!=\"Näytä kaikki\"){var f=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_rajatutPaikat=paikat.filter(function(paikka){return paikka.maakunta==valittuMaakunta&&paikka.tyyppi==valittuTyyppi;});case 1:case\"end\":return _context.stop();}}},_callee);}));return function f(){return _ref.apply(this,arguments);};}();var _rajatutPaikat=[];f().then(function(){return setRajatutPaikat([_rajatutPaikat]);});}else if(valittuTyyppi==\"Näytä kaikki\"){paivitaPaikatMaakunnassa();}};// Luo ja palauttaa maakunnat -dropvalikon\nvar luoMaakuntaValikko=function luoMaakuntaValikko(){var selectBox=document.getElementById(\"inputMaakunnat\");var options=Object.values(maakunnat).map(function(maakunta,index){return/*#__PURE__*/_jsx(\"p\",{className:\"valinnat\",onClick:function onClick(e){selectBox.value=e.target.innerHTML;setValittuMaakunta(e.target.innerHTML);selectBox.focus();setToggleMaakunnatClick(false);},children:maakunta},index);});return/*#__PURE__*/_jsx(animated.div,{style:maakunnatFade,id:\"maakunnatContainer\",className:\"options\",children:options});};// Luo ja palauttaa tyypit -dropvalikon\nvar luoTyypitValikko=function luoTyypitValikko(){var selectBox=document.getElementById(\"inputTyypit\");var options=Object.values(tyypit).map(function(tyyppi,index){return/*#__PURE__*/_jsx(\"p\",{className:\"valinnat\",onClick:function onClick(e){selectBox.value=e.target.innerHTML;setValittuTyyppi(e.target.innerHTML);selectBox.focus();setToggleTyypitClick(false);},children:tyyppi},index);});return/*#__PURE__*/_jsx(animated.div,{style:tyypitFade,id:\"tyypitContainer\",className:\"options\",children:options});};// Palauttaa ohjelman\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"app-container\",children:!isLoading?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{id:\"inputMaakunnat\",type:\"text\",value:valittuMaakunta,onClick:function onClick()/* naytaMaakunnat() */{/* setNaytaMaakuntaValikko(true); */setToggleMaakunnatClick(!toggleMaakunnatClick);},placeholder:\"Valitse maakunta\",readOnly:true}),luoMaakuntaValikko(),/*#__PURE__*/_jsx(\"input\",{id:\"inputTyypit\",inputMode:\"text\",value:valittuTyyppi,onClick:function onClick(){setToggleTyypitClick(!toggleTyypitClick);},placeholder:\"Valitse tyyppi\",readOnly:true}),luoTyypitValikko(),maakunnat.length>0&&tyypit.length>0&&paikat&&rajatutPaikat&&/*#__PURE__*/_jsxs(\"div\",{className:\"map-chart-wrapper\",children:[/*#__PURE__*/_jsx(Map,{className:\"map\",maakunta:valittuMaakunta,tyyppi:valittuTyyppi,kaikkiPaikat:_toConsumableArray(paikatMaakunnassa),rajatutPaikat:_toConsumableArray(rajatutPaikat),newLat:newLat,newLong:newLong}),/*#__PURE__*/_jsxs(\"div\",{className:\"chart-wrapper\",children:[/*#__PURE__*/_jsx(BarChart,{tyypit:_toConsumableArray(tyypit),paikatMaakunnassa:chartData,rajatutPaikat:rajatutPaikat}),/*#__PURE__*/_jsx(PieChart,{paikat:_toConsumableArray(tyypit),paikatMaakunnassa:chartData})]})]})]}):/*#__PURE__*/_jsxs(\"div\",{style:{position:\"relative\",top:300,color:\"white\",fontSize:\"30px\",textAlign:\"center\"},children:[/*#__PURE__*/_jsx(BeatLoader,{size:50,color:\"white\",loading:true}),/*#__PURE__*/_jsx(\"br\",{}),\"Loading...\"]})});}export default App;","map":{"version":3,"sources":["C:/Users/sauli/OneDrive/Työpöytä/JAMK/retkisofta/retkiohjelma/src/App.js"],"names":["React","useState","useEffect","useSpring","animated","Map","BarChart","PieChart","BeatLoader","MapboxWorker","mapboxgl","workerClass","API_URL","App","paikat","setPaikat","maakunnat","setMaakunnat","tyypit","setTyypit","valittuMaakunta","setValittuMaakunta","valittuTyyppi","setValittuTyyppi","rajatutPaikat","setRajatutPaikat","paikatMaakunnassa","setPaikatMaakunnassa","newLat","setNewLat","newLong","setNewLong","toggleMaakunnatClick","setToggleMaakunnatClick","toggleTyypitClick","setToggleTyypitClick","chartData","setChartData","isLoading","setIsLoading","maakunnatFade","position","border","height","width","tyypitFade","fetch","Accept","then","response","console","log","json","jsonData","paikatArr","maakunnatArr","tyypitArr","push","i","maakunta","tyyppi","maakunnatRemoveDuplicates","Set","tyypitRemoveDublicates","paivitaPaikatMaakunnassa","paivitaChartData","paivitaPaikat","chartDataArr","filter","paikka","paikatMaakunnassaArr","splitKoordinaatit","koordinaatti","split","f","luoMaakuntaValikko","selectBox","document","getElementById","options","Object","values","map","index","e","value","target","innerHTML","focus","luoTyypitValikko","length","top","color","fontSize","textAlign"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useSpring, animated } from \"react-spring\";\nimport Map from \"./Map\";\nimport BarChart from \"./BarChart\";\nimport PieChart from \"./PieChart\";\nimport { BeatLoader } from \"react-spinners\";\n// Ilman näitä kartta ei toimi serverillä\n// eslint-disable-next-line import/no-webpack-loader-syntax\nimport MapboxWorker from \"worker-loader!mapbox-gl/dist/mapbox-gl-csp-worker\";\nmapboxgl.workerClass = MapboxWorker;\n\n// Tulikartta API\nconst API_URL = \"https://tulikartta.fi/api-json2.php\";\n\nfunction App() {\n  const [paikat, setPaikat] = useState([]);\n  const [maakunnat, setMaakunnat] = useState([]);\n  const [tyypit, setTyypit] = useState([]);\n  const [valittuMaakunta, setValittuMaakunta] = useState(\"\");\n  const [valittuTyyppi, setValittuTyyppi] = useState(\"\");\n  const [rajatutPaikat, setRajatutPaikat] = useState([]);\n  const [paikatMaakunnassa, setPaikatMaakunnassa] = useState([]);\n  const [newLat, setNewLat] = useState();\n  const [newLong, setNewLong] = useState();\n  const [toggleMaakunnatClick, setToggleMaakunnatClick] = useState(false);\n  const [toggleTyypitClick, setToggleTyypitClick] = useState(false);\n  const [chartData, setChartData] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n\n  // Maakunnat -valikon dropdown animaatio\n  const maakunnatFade = useSpring({\n    position: \"absolute\",\n    border: toggleMaakunnatClick ? 1 : 0,\n    height: toggleMaakunnatClick ? 100 : 0,\n    width: 200,\n  });\n\n  // Tyypit -valikon dropdown animaatio\n  const tyypitFade = useSpring({\n    position: \"absolute\",\n    border: toggleTyypitClick ? 1 : 0,\n    height: toggleTyypitClick ? 100 : 0,\n    width: 200,\n  });\n\n  // Sivun latautuessa haetaan data\n  useEffect(() => {\n    fetch(API_URL, {\n      \"Content-Type\": \"application/json\",\n      Accept: \"application/json\",\n    })\n      .then((response) => {\n        console.log(response);\n        return response.json();\n      })\n      .then((jsonData) => {\n        const paikatArr = [...jsonData];\n        const maakunnatArr = [];\n        const tyypitArr = [];\n\n        tyypitArr.push(\"Näytä kaikki\");\n\n        for (let i of paikatArr) {\n          maakunnatArr.push(i.maakunta);\n          tyypitArr.push(i.tyyppi);\n        }\n        const maakunnatRemoveDuplicates = [...new Set(maakunnatArr)];\n        const tyypitRemoveDublicates = [...new Set(tyypitArr)];\n\n        setPaikat([...jsonData]);\n        setMaakunnat([...maakunnatRemoveDuplicates]);\n        setTyypit([...tyypitRemoveDublicates]);\n        setIsLoading(false);\n      });\n  }, []);\n\n  // Päivitetään paikat valitussa maakunnassa kun valitaan maakunta\n  useEffect(() => {\n    paivitaPaikatMaakunnassa();\n    paivitaChartData();\n    return () => {};\n  }, [valittuMaakunta]);\n\n  // Päivitetään kaikki paikat kun valitaan tyyppi\n  useEffect(() => {\n    paivitaPaikat();\n  }, [valittuTyyppi]);\n\n  // Päivittää kaavioille lähetettävän datan\n  const paivitaChartData = () => {\n    const chartDataArr = paikat.filter(\n      (paikka) => paikka.maakunta == valittuMaakunta\n    );\n\n    setChartData([chartDataArr]);\n  };\n\n  // Päivittää paikat valitussa maakunnassa\n  const paivitaPaikatMaakunnassa = () => {\n    let paikatMaakunnassaArr = [];\n\n    if (valittuTyyppi == \"Näytä kaikki\" || valittuTyyppi == \"\") {\n      paikatMaakunnassaArr = paikat.filter(\n        (paikka) => paikka.maakunta == valittuMaakunta\n      );\n      setChartData([paikatMaakunnassaArr]);\n    } else {\n      paikatMaakunnassaArr = paikat.filter(\n        (paikka) =>\n          paikka.maakunta == valittuMaakunta && paikka.tyyppi == valittuTyyppi\n      );\n    }\n    setPaikatMaakunnassa([paikatMaakunnassaArr]);\n    setRajatutPaikat([paikatMaakunnassaArr]);\n\n    if (valittuMaakunta != \"\" && paikatMaakunnassaArr[0]) {\n      const splitKoordinaatit = paikatMaakunnassaArr[0].koordinaatti.split(\",\");\n      setNewLat(splitKoordinaatit[0]);\n      setNewLong(splitKoordinaatit[1]);\n    }\n  };\n\n  // Päivittää kaikki paikat valitun maakunnan ja tyypin mukaan\n  const paivitaPaikat = () => {\n    if (valittuMaakunta != \"\" && valittuTyyppi != \"Näytä kaikki\") {\n      let rajatutPaikat = [];\n      async function f() {\n        {\n          rajatutPaikat = paikat.filter(\n            (paikka) =>\n              paikka.maakunta == valittuMaakunta &&\n              paikka.tyyppi == valittuTyyppi\n          );\n        }\n      }\n      f().then(() => setRajatutPaikat([rajatutPaikat]));\n    } else if (valittuTyyppi == \"Näytä kaikki\") {\n      paivitaPaikatMaakunnassa();\n    }\n  };\n\n  // Luo ja palauttaa maakunnat -dropvalikon\n  const luoMaakuntaValikko = () => {\n    let selectBox = document.getElementById(\"inputMaakunnat\");\n    const options = Object.values(maakunnat).map((maakunta, index) => (\n      <p\n        key={index}\n        className=\"valinnat\"\n        onClick={(e) => {\n          selectBox.value = e.target.innerHTML;\n          setValittuMaakunta(e.target.innerHTML);\n          selectBox.focus();\n          setToggleMaakunnatClick(false);\n        }}\n      >\n        {maakunta}\n      </p>\n    ));\n\n    return (\n      <animated.div\n        style={maakunnatFade}\n        id={\"maakunnatContainer\"}\n        className=\"options\"\n      >\n        {options}\n      </animated.div>\n    );\n  };\n\n  // Luo ja palauttaa tyypit -dropvalikon\n  const luoTyypitValikko = () => {\n    let selectBox = document.getElementById(\"inputTyypit\");\n    const options = Object.values(tyypit).map((tyyppi, index) => (\n      <p\n        key={index}\n        className=\"valinnat\"\n        onClick={(e) => {\n          selectBox.value = e.target.innerHTML;\n          setValittuTyyppi(e.target.innerHTML);\n          selectBox.focus();\n          setToggleTyypitClick(false);\n        }}\n      >\n        {tyyppi}\n      </p>\n    ));\n\n    return (\n      <animated.div\n        style={tyypitFade}\n        id={\"tyypitContainer\"}\n        className=\"options\"\n      >\n        {options}\n      </animated.div>\n    );\n  };\n\n  // Palauttaa ohjelman\n  return (\n    <div className=\"app-container\">\n      {!isLoading ? (\n        <div>\n          <input\n            id={\"inputMaakunnat\"}\n            type={\"text\"}\n            value={valittuMaakunta}\n            onClick={() => /* naytaMaakunnat() */ {\n              /* setNaytaMaakuntaValikko(true); */\n              setToggleMaakunnatClick(!toggleMaakunnatClick);\n            }}\n            placeholder={\"Valitse maakunta\"}\n            readOnly\n          ></input>\n          {luoMaakuntaValikko()}\n\n          <input\n            id={\"inputTyypit\"}\n            inputMode={\"text\"}\n            value={valittuTyyppi}\n            onClick={() => {\n              setToggleTyypitClick(!toggleTyypitClick);\n            }}\n            placeholder={\"Valitse tyyppi\"}\n            readOnly\n          ></input>\n\n          {luoTyypitValikko()}\n\n          {maakunnat.length > 0 &&\n            tyypit.length > 0 &&\n            paikat &&\n            rajatutPaikat && (\n              <div className=\"map-chart-wrapper\">\n                <Map\n                  className=\"map\"\n                  maakunta={valittuMaakunta}\n                  tyyppi={valittuTyyppi}\n                  kaikkiPaikat={[...paikatMaakunnassa]}\n                  rajatutPaikat={[...rajatutPaikat]}\n                  newLat={newLat}\n                  newLong={newLong}\n                ></Map>\n                <div className=\"chart-wrapper\">\n                  <BarChart\n                    tyypit={[...tyypit]}\n                    paikatMaakunnassa={chartData}\n                    rajatutPaikat={rajatutPaikat}\n                  ></BarChart>\n\n                  <PieChart\n                    paikat={[...tyypit]}\n                    paikatMaakunnassa={chartData}\n                  ></PieChart>\n                </div>\n              </div>\n            )}\n        </div>\n      ) : (\n        <div\n          style={{\n            position: \"relative\",\n            top: 300,\n            color: \"white\",\n            fontSize: \"30px\",\n            textAlign: \"center\",\n          }}\n        >\n          <BeatLoader size={50} color=\"white\" loading></BeatLoader>\n          <br />\n          Loading...\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}